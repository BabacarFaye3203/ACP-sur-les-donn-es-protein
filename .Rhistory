#  Lecture et préparation des données
protein <- read.csv("protein.txt", header=TRUE, stringsAsFactors=FALSE)
rownames(protein) <- protein$Country
x <- protein[, -1]
x <- as.data.frame(lapply(x, as.numeric))
# Vérification
str(x)
boxplot(x, main="Boxplots de consommation alimentaire par pays")
summary(t(x))
#  Matrice de corrélation
matCors <- cor(x)
matCors
library(corrplot)
corrplot(matCors, type="upper", order="hclust", tl.col="black", tl.srt=45)
#  ACP avec prcomp
res.pca <- prcomp(x, center=TRUE, scale.=TRUE)
# Valeurs propres et proportion de variance expliquée
res.pca$sdev^2
prop_var <- (res.pca$sdev^2)/sum(res.pca$sdev^2)
cumsum(prop_var)
plot(prop_var, type="b", main="Variance expliquée par chaque PC", xlab="PC", ylab="Proportion")
# ⃣ Composantes principales
CP <- res.pca$x
cos2 <- rowSums(CP^2)/sum(res.pca$sdev^2)
CP[1:5,]
# ⃣ Contributions
n <- nrow(x)
contrib <- CP^2 / (n * matrix(res.pca$sdev^2, nrow=n, ncol=ncol(CP), byrow=TRUE))
contrib[1:5,]
# ⃣ Représentation graphique
plot(CP[,1:2], pch=16, cex=cos2*5, xlab="PC1", ylab="PC2", main="Projection des pays sur PC1-PC2")
text(CP[,1:2], labels=rownames(CP), pos=3)
# ⃣ Corrélation des variables avec les PC
Rho <- cor(x, CP)
Rho
# ⃣ ACP avec FactoMineR pour plus d’options
library(FactoMineR)
library(factoextra)
res.acp <- PCA(x, graph=FALSE)
# Valeurs propres et scree plot
eig.val <- get_eigenvalue(res.acp)
eig.val
fviz_eig(res.acp, addlabels = TRUE)
# Variables
var <- get_pca_var(res.acp)
head(var$coord)      # coordonnées
head(var$cos2)       # qualité de représentation
head(var$contrib)    # contributions
# Graphiques
fviz_pca_var(res.acp, col.var="cos2", gradient.cols=c("#00AFBB","#E7B800","#FC4E07"), repel=TRUE)
fviz_contrib(res.acp, choice="var", axes=1:2, top=10)
fviz_pca_biplot(res.acp, repel=TRUE, col.var="#2E9FDF", col.ind="#696969")
fviz_pca_var(res.acp, col.var="cos2", gradient.cols=c("#00AFBB","#E7B800","#FC4E07"), repel=TRUE)
fviz_contrib(res.acp, choice="var", axes=1:2, top=10)
fviz_pca_biplot(res.acp, repel=TRUE, col.var="#2E9FDF", col.ind="#696969")
#  Lecture et préparation des données
protein <- read.csv("protein.txt", header=TRUE, stringsAsFactors=FALSE)
rownames(protein) <- protein$Country
x <- protein[, -1]
x <- as.data.frame(lapply(x, as.numeric))
# Vérification
str(x)
boxplot(x, main="Boxplots de consommation alimentaire par pays")
summary(t(x))
#  Matrice de corrélation
matCors <- cor(x)
matCors
library(corrplot)
corrplot(matCors, type="upper", order="hclust", tl.col="black", tl.srt=45)
#  ACP avec prcomp
res.pca <- prcomp(x, center=TRUE, scale.=TRUE)
# Valeurs propres et proportion de variance expliquée
res.pca$sdev^2
prop_var <- (res.pca$sdev^2)/sum(res.pca$sdev^2)
cumsum(prop_var)
plot(prop_var, type="b", main="Variance expliquée par chaque PC", xlab="PC", ylab="Proportion")
# ⃣ Composantes principales
CP <- res.pca$x
cos2 <- rowSums(CP^2)/sum(res.pca$sdev^2)
CP[1:5,]
# ⃣ Contributions
n <- nrow(x)
contrib <- CP^2 / (n * matrix(res.pca$sdev^2, nrow=n, ncol=ncol(CP), byrow=TRUE))
contrib[1:5,]
# ⃣ Représentation graphique
plot(CP[,1:2], pch=16, cex=cos2*5, xlab="PC1", ylab="PC2", main="Projection des pays sur PC1-PC2")
text(CP[,1:2], labels=rownames(CP), pos=3)
# ⃣ Corrélation des variables avec les PC
Rho <- cor(x, CP)
Rho
# ⃣ ACP avec FactoMineR pour plus d’options
library(FactoMineR)
library(factoextra)
res.acp <- PCA(x, graph=FALSE)
# Valeurs propres et scree plot
eig.val <- get_eigenvalue(res.acp)
eig.val
fviz_eig(res.acp, addlabels = TRUE)
# Variables
var <- get_pca_var(res.acp)
head(var$coord)      # coordonnées
head(var$cos2)       # qualité de représentation
head(var$contrib)    # contributions
# Graphiques
fviz_pca_var(res.acp, col.var="cos2", gradient.cols=c("#00AFBB","#E7B800","#FC4E07"), repel=TRUE)
fviz_contrib(res.acp, choice="var", axes=1:2, top=10)
fviz_pca_biplot(res.acp, repel=TRUE, col.var="#2E9FDF", col.ind="#696969")
